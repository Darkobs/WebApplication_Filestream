name: "Jira Transitions on PR Events"

on:
  pull_request:
    types: [ready_for_review]
    branches: [main]

jobs: 
  send_slack:
    runs-on: ubuntu-latest

    steps:
      - name: Extract Jira issue key from PR
        id: key
        run: |
          TITLE="${{ github.event.pull_request.title }}"
          BRANCH="${{ github.event.pull_request.head.ref }}"
          BODY="${{ github.event.pull_request.body }}"
          KEY=$(printf "%s\n%s\n%s" "$TITLE" "$BRANCH" "$BODY" | grep -oE '[A-Z][A-Z0-9]+-[0-9]+' | head -n1)
          echo "key=$KEY" >> $GITHUB_OUTPUT
